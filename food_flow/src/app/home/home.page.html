<ion-content [fullscreen]="true" class="content-with-header">
  <!-- Header como div dentro do conteúdo -->
  <div class="sticky-header">
    <div class="header-container">
      <!-- Logo do App -->
      <div class="logo-section">
        <div class="logo-icon">
          <span>F</span>
        </div>
        <h1 class="logo-text">FoodFlow</h1>
      </div>

      <!-- Endereço de Entrega -->
      <div class="delivery-address">
        <div class="address-info">
          <p class="address-label">Delivery:</p>
          <p class="address-text">{{ userAddress }}</p>
        </div>
        <ion-icon name="chevron-down-outline" class="chevron-icon"></ion-icon>
      </div>

      <!-- Barra de Busca -->
      <div class="search-container">
        <ion-searchbar 
          placeholder="Bib'sfiha, Lanches, Sobremesas..." 
          [(ngModel)]="searchQuery"
          (ionInput)="onSearchChange($event)"
          class="custom-searchbar">
        </ion-searchbar>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Carregando restaurantes...</p>
  </div>

  <!-- Content when loaded -->
  <div *ngIf="!loading">
    <!-- Seção de Destaque -->
    <section class="featured-section">
      <div class="featured-card">
        <div class="featured-image">
          <img src="assets/images/hero-burger.jpg" alt="Hambúrguer em destaque">
          <div class="featured-overlay"></div>
        </div>
        <div class="featured-content">
          <h2 class="featured-title">Promoção Especial!</h2>
          <p class="featured-description">Hambúrguer Gourmet com 30% de desconto</p>
          <div class="featured-info">
            <div class="rating">
              <ion-icon name="star" class="star-icon"></ion-icon>
              <span>4.8</span>
            </div>
            <div class="delivery-time">
              <ion-icon name="time-outline"></ion-icon>
              <span>25-35 min</span>
            </div>
          </div>
          <ion-button 
            fill="solid" 
            color="light" 
            size="small"
            (click)="onOrderNow()"
            class="order-button">
            Pedir Agora
          </ion-button>
        </div>
      </div>
    </section>

    <!-- Seção de Categorias -->
    <section class="categories-section">
      <div class="titulo-cardapio">
        <span>Categorias</span>
      </div>
      <div class="categories-scroll">
        <div 
          class="category-item" 
          *ngFor="let category of categories; let i = index"
          (click)="onCategoryClick(category, i)">
          <div class="category-card" [class.selected]="selectedCategoryIndex === i">
            <div class="category-icon">
              <ion-icon [name]="category.icon"></ion-icon>
            </div>
          </div>
          <span class="category-name">{{ category.name }}</span>
        </div>
      </div>
    </section>

    <!-- Seção de Produtos -->
    <section class="restaurants-section">
      <div class="titulo-cardapio">
        <span>Produtos em destaque</span>
      </div>
      
      <!-- Empty State -->
      <div *ngIf="featuredRestaurants.length === 0" class="empty-state">
        <ion-icon name="restaurant-outline" class="empty-icon"></ion-icon>
        <p>Nenhum produto encontrado</p>
        <ion-button fill="clear" (click)="loadData()">
          Tentar novamente
        </ion-button>
      </div>

      <!-- Products Grid -->
      <div class="products-grid" *ngIf="featuredRestaurants.length > 0">
        <div 
          class="single-product-area" 
          *ngFor="let restaurant of featuredRestaurants">
          
          <!-- Badges -->
          <div class="product-badges">
            <ion-badge 
              *ngIf="restaurant.discount" 
              class="discount-badge">
              {{ restaurant.discount.percentage }}% OFF
            </ion-badge>
            <ion-badge 
              *ngIf="restaurant.isNew" 
              class="new-badge">
              Novo
            </ion-badge>
          </div>

          <!-- Área da Imagem -->
          <div class="product-image-area" (click)="onRestaurantClick(restaurant)">
            <img [src]="restaurant.image" [alt]="restaurant.name">
          </div>

          <!-- Nome do Produto -->
          <div class="item_cardapio_botoes">
            <span class="item_nome posicao-fonte">{{ restaurant.name }}</span>
          </div>

          <!-- Área Inferior - Preço e Botão -->
          <div class="product-botom-area">
            <h3>{{ formatPrice(19.80) }}</h3>
            <ion-button 
              color="primary" 
              (click)="onAddToCart(restaurant)">
              <ion-icon slot="icon-only" name="add"></ion-icon>
            </ion-button>
          </div>
        </div>
      </div>
    </section>
  </div>
</ion-content>

<!-- Botão do Carrinho Flutuante -->
<ion-fab vertical="bottom" horizontal="end" slot="fixed">
  <ion-fab-button 
    color="primary" 
    (click)="onCartClick()"
    class="cart-fab">
    <ion-icon name="cart-outline"></ion-icon>
    <ion-badge color="danger" class="cart-badge">3</ion-badge>
  </ion-fab-button>
</ion-fab>
